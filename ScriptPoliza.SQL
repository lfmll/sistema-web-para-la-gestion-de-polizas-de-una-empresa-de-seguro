CREATE TABLE PolizaBeneficiario
(
	IdPoliza SMALLINT UNSIGNED NOT NULL,
	IdBeneficiario SMALLINT NOT NULL,
	Indemnizacion SMALLINT UNSIGNED NOT NULL,
	KEY (IdBeneficiario),
	KEY (IdPoliza)
) 
;


CREATE TABLE Poliza
(
	IdPoliza SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	FechaInicio DATE NOT NULL,
	FechaFin DATE NOT NULL,
	Cobertura DOUBLE UNSIGNED NOT NULL,
	IdIntermediario SMALLINT UNSIGNED NULL,
	IdPlanPago SMALLINT UNSIGNED NOT NULL,
	IdBeneficiario SMALLINT UNSIGNED NOT NULL,
	IdCliente SMALLINT UNSIGNED NOT NULL,
	IdSeguro SMALLINT UNSIGNED NULL,
	IdPersonal SMALLINT UNSIGNED NOT NULL,
	PRIMARY KEY (IdPoliza),
	KEY (IdCliente),
	KEY (IdIntermediario),
	KEY (IdPersonal),
	KEY (IdPlanPago),
	KEY (IdSeguro)
) 
;


CREATE TABLE EmpresaCorredora
(
	IdEmpresaCorredora SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nombre NVARCHAR(50) NOT NULL,
	Descripcion NVARCHAR(150) NULL,
	PRIMARY KEY (IdEmpresaCorredora)
) 
;


CREATE TABLE Intermediario
(
	IdIntermediario SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nombre NVARCHAR(50) NOT NULL,
	Apellido NVARCHAR(50) NOT NULL,
	Ci INTEGER UNSIGNED NOT NULL,
	Telefono INTEGER UNSIGNED NOT NULL,
	IdEmpresaCorredora SMALLINT UNSIGNED NOT NULL,
	PRIMARY KEY (IdIntermediario),
	KEY (IdEmpresaCorredora)
) 
;


CREATE TABLE Clausula
(
	IdClausula SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Descripcion NVARCHAR(250) NOT NULL,
	IdPoliza SMALLINT UNSIGNED NOT NULL,
	PRIMARY KEY (IdClausula),
	KEY (IdPoliza)
) 
;


CREATE TABLE DetalleSeguro
(
	IdDetalleSeguro SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Descripcion NVARCHAR(250) NOT NULL,
	IdSeguro SMALLINT UNSIGNED NOT NULL,
	PRIMARY KEY (IdDetalleSeguro),
	KEY (IdSeguro)
) 
;


CREATE TABLE Privilegio
(
	IdPrivilegio SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Descripcion NVARCHAR(50) NOT NULL,
	PRIMARY KEY (IdPrivilegio)
) 
;


CREATE TABLE GrupoPrivilegio
(
	IdGrupo SMALLINT UNSIGNED NOT NULL,
	IdPrivilegio SMALLINT UNSIGNED NOT NULL,
	KEY (IdGrupo),
	KEY (IdPrivilegio)
) 
;


CREATE TABLE Grupo
(
	IdGrupo SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Descripcion NVARCHAR(25) NOT NULL,
	PRIMARY KEY (IdGrupo)
) 
;


CREATE TABLE Usuario
(
	IdUsuario SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nick NVARCHAR(50) NOT NULL,
	Clave NVARCHAR(50) NOT NULL,
	IdGrupo SMALLINT UNSIGNED NOT NULL,
	PRIMARY KEY (IdUsuario),
	KEY (IdGrupo)
) 
;


CREATE TABLE Cargo
(
	IdCargo SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nombre NVARCHAR(50) NOT NULL,
	Descripcion NVARCHAR(150) NULL,
	PRIMARY KEY (IdCargo)
) 
;


CREATE TABLE Personal
(
	IdPersonal SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nombre NVARCHAR(50) NOT NULL,
	Apellido NVARCHAR(50) NOT NULL,
	CI INTEGER UNSIGNED NOT NULL,
	Direccion NVARCHAR(50) NULL,
	Sexo CHAR(10) NOT NULL,
	Telefono INTEGER UNSIGNED NOT NULL,
	Celular INTEGER NULL,
	Estado BIT NULL,
	IdEmpresaAseguradora SMALLINT UNSIGNED NOT NULL,
	IdUsuario SMALLINT UNSIGNED NOT NULL,
	IdCargo SMALLINT UNSIGNED NOT NULL,
	PRIMARY KEY (IdPersonal),
	KEY (IdCargo),
	KEY (IdEmpresaAseguradora),
	KEY (IdUsuario)
) 
;


CREATE TABLE EmpresaAseguradora
(
	IdEmpresaAseguradora SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nombre NVARCHAR(50) NOT NULL,
	Direccion NVARCHAR(100) NULL,
	Telefono INTEGER UNSIGNED NOT NULL,
	Email NVARCHAR(100) NULL,
	PRIMARY KEY (IdEmpresaAseguradora)
) 
;


CREATE TABLE Beneficiario
(
	IdBeneficiario SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nombre NVARCHAR(50) NOT NULL,
	Apellido NVARCHAR(50) NOT NULL,
	CI INTEGER UNSIGNED NOT NULL,
	Telefono INTEGER UNSIGNED NOT NULL,
	Celular INTEGER UNSIGNED NULL,
	Direccion NVARCHAR(100) NULL,
	PRIMARY KEY (IdBeneficiario)
) 
;


CREATE TABLE Cliente
(
	IdCliente SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nombre NVARCHAR(50) NOT NULL,
	Apellido NVARCHAR(50) NOT NULL,
	Ci INTEGER UNSIGNED NOT NULL,
	Direccion NVARCHAR(100) NOT NULL,
	Ciudad NVARCHAR(10) NOT NULL,
	Telefono INTEGER UNSIGNED NOT NULL,
	Celular INTEGER UNSIGNED NOT NULL,
	Genero CHAR(1) NOT NULL,
	Nit INTEGER UNSIGNED NULL,
	FechaNac DATE NOT NULL,
	TipoCliente VARCHAR(50) NOT NULL,
	Estado BIT NOT NULL,
	PRIMARY KEY (IdCliente)
) 
;


CREATE TABLE Seguro
(
	IdSeguro SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Nombre NVARCHAR(50) NOT NULL,
	Descripcion NVARCHAR(200) NULL,
	PRIMARY KEY (IdSeguro)
) 
;


CREATE TABLE PlanPago
(
	IdPlanPago SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Saldo DOUBLE NOT NULL,
	Estado NVARCHAR(15) NOT NULL,
	PRIMARY KEY (IdPlanPago)
) 
;


CREATE TABLE Cuota
(
	IdCuota SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
	Monto DOUBLE NOT NULL,
	FechaPago DATE NOT NULL,
	IdPlanPago SMALLINT UNSIGNED NOT NULL,
	PRIMARY KEY (IdCuota),
	KEY (IdPlanPago)
) 
;





ALTER TABLE PolizaBeneficiario ADD CONSTRAINT FK_PolizaBeneficiario_Beneficiario 
	FOREIGN KEY (IdBeneficiario) REFERENCES Beneficiario (IdBeneficiario)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE PolizaBeneficiario ADD CONSTRAINT FK_PolizaBeneficiario_Poliza 
	FOREIGN KEY (IdPoliza) REFERENCES Poliza (IdPoliza)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Poliza ADD CONSTRAINT FK_Poliza_Cliente 
	FOREIGN KEY (IdCliente) REFERENCES Cliente (IdCliente)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Poliza ADD CONSTRAINT FK_Poliza_Intermediario 
	FOREIGN KEY (IdIntermediario) REFERENCES Intermediario (IdIntermediario)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Poliza ADD CONSTRAINT FK_Poliza_Personal 
	FOREIGN KEY (IdPersonal) REFERENCES Personal (IdPersonal)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Poliza ADD CONSTRAINT FK_Poliza_PlanPago 
	FOREIGN KEY (IdPlanPago) REFERENCES PlanPago (IdPlanPago)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Poliza ADD CONSTRAINT FK_Poliza_Seguro 
	FOREIGN KEY (IdSeguro) REFERENCES Seguro (IdSeguro)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Intermediario ADD CONSTRAINT FK_Intermediario_EmpresaCorredora 
	FOREIGN KEY (IdEmpresaCorredora) REFERENCES EmpresaCorredora (IdEmpresaCorredora)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Clausula ADD CONSTRAINT FK_Clausula_Poliza 
	FOREIGN KEY (IdPoliza) REFERENCES Poliza (IdPoliza)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE DetalleSeguro ADD CONSTRAINT FK_DetalleSeguro_Seguro 
	FOREIGN KEY (IdSeguro) REFERENCES Seguro (IdSeguro)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE GrupoPrivilegio ADD CONSTRAINT FK_GrupoPrivilegio_Grupo 
	FOREIGN KEY (IdGrupo) REFERENCES Grupo (IdGrupo)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE GrupoPrivilegio ADD CONSTRAINT FK_GrupoPrivilegio_Privilegio 
	FOREIGN KEY (IdPrivilegio) REFERENCES Privilegio (IdPrivilegio)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Usuario ADD CONSTRAINT FK_Usuario_Grupo 
	FOREIGN KEY (IdGrupo) REFERENCES Grupo (IdGrupo)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Personal ADD CONSTRAINT FK_Personal_Cargo 
	FOREIGN KEY (IdCargo) REFERENCES Cargo (IdCargo)
;

ALTER TABLE Personal ADD CONSTRAINT FK_Personal_EmpresaAseguradora 
	FOREIGN KEY (IdEmpresaAseguradora) REFERENCES EmpresaAseguradora (IdEmpresaAseguradora)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Personal ADD CONSTRAINT FK_Personal_Usuario 
	FOREIGN KEY (IdUsuario) REFERENCES Usuario (IdUsuario)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE Cuota ADD CONSTRAINT FK_Cuota_PlanPago 
	FOREIGN KEY (IdPlanPago) REFERENCES PlanPago (IdPlanPago)
	ON DELETE CASCADE ON UPDATE CASCADE
;
